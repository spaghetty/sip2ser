From 5f4cc075fbbd69b326550592bc78a88a8384efd2 Mon Sep 17 00:00:00 2001
From: Domenico Chierico <domenico.chierico@sip2ser.it>
Date: Tue, 19 Jun 2012 15:48:21 +0200
Subject: [PATCH] workaround for boost

---
 sipXproxy/configure.ac    |    7 +++++++
 sipXproxy/src/Makefile.am |    2 +-
 2 files changed, 8 insertions(+), 1 deletions(-)

diff --git a/sipXproxy/configure.ac b/sipXproxy/configure.ac
index 13873d9..11dbbb9 100644
--- a/sipXproxy/configure.ac
+++ b/sipXproxy/configure.ac
@@ -8,6 +8,12 @@ SFAC_AUTOMAKE_VERSION([1.6])
 AC_CONFIG_SRCDIR([src/sipXproxymain.cpp])
 AM_CONFIG_HEADER([src/config.h])
 AC_PROG_LIBTOOL
+AC_CHECK_LIB(boost_thread, main, [BOOST_LDADD="-lboost_thread"],
+			    [AC_CHECK_LIB(boost_thread-mt, main,
+			    				   [BOOST_LDADD="-lboost_thread-mt"],
+							   [AC_MSG_ERROR("no boost thread found")]
+					)])
+
 AC_PATH_PROG([BASH], [bash])
 AC_PROG_CXX
 AX_COMPILER_VENDOR
@@ -23,6 +29,7 @@ CHECK_RUBY([1.8.2])
 CHECK_RAKE([0.5.3])
 CHECK_GEM([0.8.11])
 CHECK_ODBC
+AC_SUBST(BOOST_LDADD)
 AC_ARG_ENABLE(cse-tests,
   AC_HELP_STRING([--enable-cse-tests], [Run unit tests that test saving CSE data to postgres db setup]),
   enable_cse_tests=yes)
diff --git a/sipXproxy/src/Makefile.am b/sipXproxy/src/Makefile.am
index 4aa304d..45518c2 100644
--- a/sipXproxy/src/Makefile.am
+++ b/sipXproxy/src/Makefile.am
@@ -21,7 +21,7 @@ sipXproxy_LDADD = \
 	libsipXproxy.la \
 	@SIPXCOMMSERVER_LIBS@ \
 	-lboost_system \
-	-lboost_thread
+	@BOOST_LDADD@
 
 sipXproxy_SOURCES =  \
 	sipXproxymain.cpp
-- 
1.7.4.4

